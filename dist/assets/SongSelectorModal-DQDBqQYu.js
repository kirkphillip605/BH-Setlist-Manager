import{j as e}from"./index-Babt8UfR.js";import{r as s}from"./vendor-react-ET7pSeaL.js";import{b as t}from"./services-P15qPlA6.js";import{M as n,u as i,X as l,p as r}from"./vendor-ui-CCR3b1TD.js";const c=({isOpen:c,onClose:a,onSongsSelected:o,selectedSongs:d=[]})=>{const[x,m]=s.useState([]),[u,b]=s.useState(!0),[h,p]=s.useState(null),[g,f]=s.useState(""),[j,v]=s.useState(1),[N]=s.useState(10),[z,y]=s.useState([]),w=s.useMemo(()=>{if(!g.trim())return x;const e=g.toLowerCase().replace(/[^\w\s]/g,"").trim();return x.filter(s=>{const t=s.title.toLowerCase().replace(/[^\w\s]/g,""),n=s.original_artist.toLowerCase().replace(/[^\w\s]/g,""),i=`${t} ${n}`;return e.split(/\s+/).every(e=>t.includes(e)||n.includes(e)||i.includes(e))})},[x,g]);s.useEffect(()=>{c&&k()},[c]),s.useEffect(()=>{c&&(y([]),f(""),v(1))},[c]);const k=async()=>{b(!0),p(null);try{const e=await t.getAllSongs();m(e)}catch(e){p(e.message||"Failed to fetch songs")}finally{b(!1)}},S=()=>{const e=z.map(e=>x.find(s=>s.id===e)).filter(Boolean);o(e),a()},C=Math.ceil(w.length/N),M=w.slice((j-1)*N,j*N);return c?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm transition-opacity",onClick:a}),e.jsxs("div",{className:"inline-block align-bottom bg-zinc-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsx("div",{className:"bg-zinc-800 px-6 pt-6 pb-4 border-b border-zinc-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-xl flex items-center justify-center",children:e.jsx(n,{className:"h-5 w-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-zinc-100",children:"Add Songs"}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[z.length>0&&`${z.length} selected • `,w.length," songs available"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[z.length>0&&e.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(i,{size:16,className:"mr-2"}),"Add ",z.length," Song",1!==z.length?"s":""]}),e.jsx("button",{onClick:a,className:"p-2 text-zinc-400 hover:text-zinc-200 transition-colors",children:e.jsx(l,{size:20})})]})]})}),e.jsx("div",{className:"bg-zinc-800 px-6 py-4 border-b border-zinc-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-zinc-400"}),e.jsx("input",{type:"text",placeholder:"Search songs by title or artist...",value:g,onChange:e=>{f(e.target.value),v(1)},className:"w-full pl-10 pr-4 py-3 bg-zinc-700 border border-zinc-600 text-zinc-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-zinc-400",autoFocus:!0})]})}),e.jsx("div",{className:"bg-zinc-800 px-6 py-4",style:{maxHeight:"400px",overflowY:"auto"},children:u?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-zinc-300",children:"Loading songs..."})]}):h?e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{children:h})}):e.jsxs("div",{className:"space-y-2",children:[M.map(s=>{const t=(n=s.id,d.some(e=>(e.id||e)===n));var n;const i=z.includes(s.id);return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border transition-all "+(i?"bg-blue-600/20 border-blue-500":t?"bg-green-600/20 border-green-500":"bg-zinc-700 border-zinc-600 hover:bg-zinc-650"),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-100 truncate",children:s.title}),e.jsxs("p",{className:"text-sm text-zinc-400 truncate",children:[s.original_artist,(s.key_signature||null!==s.tempo&&void 0!==s.tempo)&&e.jsxs(e.Fragment,{children:[s.key_signature&&` • ${s.key_signature}`,null!==s.tempo&&void 0!==s.tempo&&` • ${s.tempo} BPM`]})]}),s.performance_note&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx("svg",{className:"w-3 h-3 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),e.jsx("span",{className:"text-xs text-amber-300",children:s.performance_note})]})]}),e.jsx("div",{className:"ml-4",children:t?e.jsx("span",{className:"px-3 py-2 bg-green-600 text-white text-sm rounded-xl font-medium",children:"Already in Set"}):e.jsx("button",{onClick:()=>(e=>{y(s=>{const t=s.indexOf(e.id);if(-1!==t){const e=[...s];return e.splice(t,1),e}return[...s,e.id]})})(s),className:"px-4 py-2 rounded-xl font-medium transition-colors "+(i?"bg-blue-600 text-white hover:bg-blue-700":"bg-zinc-600 text-zinc-300 hover:bg-zinc-500"),children:i?"Selected":"Select"})})]},s.id)}),0===w.length&&g&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(n,{className:"h-12 w-12 text-zinc-600 mx-auto mb-3"}),e.jsxs("p",{className:"text-zinc-400",children:['No songs found for "',g,'"']}),e.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"Try a different search term"})]})]})}),C>1&&e.jsx("div",{className:"bg-zinc-700 px-6 py-4 border-t border-zinc-600",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("nav",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>v(e=>Math.max(1,e-1)),disabled:1===j,className:"px-3 py-2 rounded-lg border border-zinc-600 bg-zinc-800 text-zinc-300 hover:bg-zinc-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-zinc-300",children:[j," of ",C]}),e.jsx("button",{onClick:()=>v(e=>Math.min(C,e+1)),disabled:j===C,className:"px-3 py-2 rounded-lg border border-zinc-600 bg-zinc-800 text-zinc-300 hover:bg-zinc-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})})}),e.jsxs("div",{className:"bg-zinc-700 px-6 py-4 flex justify-between items-center",children:[e.jsx("button",{onClick:a,className:"inline-flex items-center px-4 py-2 border border-zinc-600 rounded-xl text-zinc-300 bg-zinc-800 hover:bg-zinc-700 transition-colors",children:"Cancel"}),z.length>0&&e.jsxs("button",{onClick:S,className:"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(i,{size:16,className:"mr-2"}),"Add ",z.length," Song",1!==z.length?"s":""]})]})]})]})}):null};export{c as S};
