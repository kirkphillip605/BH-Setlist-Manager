import{u as e,j as s}from"./index-Babt8UfR.js";import{l as t,h as o,r as l}from"./vendor-react-ET7pSeaL.js";import{c as n}from"./services-P15qPlA6.js";import{D as a}from"./DraggableList-C0Rm0Xlq.js";import{A as r,n as i}from"./vendor-ui-CCR3b1TD.js";import"./vendor-supabase-DKeZICmP.js";const c=()=>{const{collectionId:c}=t(),{setPageTitle:d}=e(),m=o(),[x,g]=l.useState(null),[u,p]=l.useState(!0),[h,j]=l.useState(null),[b,f]=l.useState([]);l.useEffect(()=>{N()},[c]);const N=async()=>{p(!0),j(null);try{const e=await n.getSongCollectionById(c);g(e),d(e.name);const s=e.song_collection_songs?.map(e=>({...e.songs,song_order:e.song_order})).sort((e,s)=>e.song_order-s.song_order)||[];f(s)}catch(e){j(e.message||"Failed to load collection")}finally{p(!1)}},v=async(e,s)=>{if(s&&!window.confirm(s))return;const t=b,o=e.map((e,s)=>({...e,song_order:s+1}));f(o),j(null);try{const e=o.map(e=>({song_id:e.id,song_order:e.song_order}));await n.updateSongCollection(c,{name:x.name,is_public:x.is_public,songs:e}),await N()}catch(l){j("Failed to update songs"),f(t)}};return u?s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:s.jsx("p",{className:"text-center text-slate-300",children:"Loading collection..."})})}):h||!x?s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:[s.jsx("strong",{className:"font-bold",children:"Error!"}),s.jsxs("span",{className:"block sm:inline",children:[" ",h||"Collection not found"]})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[s.jsx("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>m("/song-collections"),className:"p-2 text-slate-400 hover:text-slate-300 transition-colors",children:s.jsx(r,{size:20})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:x.name}),s.jsxs("p",{className:"text-slate-400",children:[b.length," song",1!==b.length?"s":""]})]})]}),s.jsxs("button",{onClick:()=>m(`/song-collections/edit/${c}`),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(i,{size:18,className:"mr-2"}),"Edit Collection"]})]})}),s.jsx("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:0===b.length?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-slate-300 text-lg",children:"No songs in this collection"})}):s.jsx(a,{items:b,onReorder:async(e,s)=>{if(e===s)return;const t=[...b],[o]=t.splice(e,1);t.splice(s,0,o),await v(t)},onRemove:async e=>{await v(b.filter((s,t)=>t!==e),"Are you sure you want to remove this song from the collection?")},type:"songs"})})]})};export{c as default};
