import{u as s,j as e}from"./index-Babt8UfR.js";import{l as t,h as o,r as a}from"./vendor-react-ET7pSeaL.js";import{d as r,a as n}from"./services-P15qPlA6.js";import{D as l}from"./DraggableList-C0Rm0Xlq.js";import{A as i,n as d,M as c}from"./vendor-ui-CCR3b1TD.js";import"./vendor-supabase-DKeZICmP.js";const m=()=>{const{setlistId:m,setId:x}=t(),{setPageTitle:g}=s(),u=o(),[p,h]=a.useState(null),[j,b]=a.useState([]),[f,v]=a.useState(!0),[N,y]=a.useState(null);a.useEffect(()=>{w()},[x]);const w=async()=>{v(!0),y(null);try{const[s,e]=await Promise.all([r.getSetById(x),n.getSetlistById(m)]);h(s),g(`${s.name} - ${s.setlists?.name||"Set"}`);const t=e.sets?.filter(s=>s.id!==x)||[];b(t)}catch(s){y(s.message||"Failed to load set")}finally{v(!1)}},_=async s=>{try{const e=s.map((s,e)=>({song_id:s.id,song_order:e+1}));await r.updateSet(x,{name:p.name,songs:e}),await w()}catch(e){y("Failed to update songs")}};if(f)return e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:e.jsx("p",{className:"text-center text-slate-300",children:"Loading set..."})})});if(N||!p)return e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",N||"Set not found"]})]})});const S=p.set_songs?.map(s=>({...s.songs,song_order:s.song_order})).sort((s,e)=>s.song_order-e.song_order)||[];return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsx("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>u(`/setlists/${m}`),className:"p-2 text-slate-400 hover:text-slate-300 transition-colors",children:e.jsx(i,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:p.name}),e.jsxs("p",{className:"text-slate-400",children:[S.length," song",1!==S.length?"s":""," â€¢ ",p.setlists?.name||"Setlist"]})]})]}),e.jsxs("button",{onClick:()=>u(`/setlists/${m}/sets/${x}/edit`),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(d,{size:18,className:"mr-2"}),"Edit Set"]})]})}),e.jsx("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:0===S.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(c,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),e.jsx("p",{className:"text-slate-300 text-lg",children:"No songs in this set"}),e.jsx("p",{className:"text-slate-400 mb-6",children:"Add songs to build your set"}),e.jsxs("button",{onClick:()=>u(`/setlists/${m}/sets/${x}/edit`),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(d,{size:18,className:"mr-2"}),"Add Songs"]})]}):e.jsx(l,{items:S,onReorder:async(s,e)=>{const t=[...p.set_songs?.map(s=>({...s.songs,song_order:s.song_order})).sort((s,e)=>s.song_order-e.song_order)||[]],[o]=t.splice(s,1);t.splice(e,0,o);const a=t.map((s,e)=>({...s,song_order:e+1}));await _(a)},onRemove:async s=>{if(!window.confirm("Are you sure you want to remove this song from the set?"))return;const e=(p.set_songs?.map(s=>({...s.songs,song_order:s.song_order})).sort((s,e)=>s.song_order-e.song_order)||[]).filter((e,t)=>t!==s);await _(e)},onMoveToSet:async(s,e)=>{try{await r.moveSongToSet(s,x,e),await w()}catch(t){y("Failed to move song")}},availableSets:j,type:"songs",showMoveToSet:!0})})]})};export{m as default};
