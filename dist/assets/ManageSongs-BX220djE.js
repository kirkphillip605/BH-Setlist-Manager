import{j as e,u as s,a as t}from"./index-Babt8UfR.js";import{r as i,h as l,L as n}from"./vendor-react-ET7pSeaL.js";import{b as a}from"./services-P15qPlA6.js";import{n as r,o as c,M as o,p as d,q as m,r as x,s as u}from"./vendor-ui-CCR3b1TD.js";import"./vendor-supabase-DKeZICmP.js";const h=({columns:s,data:t})=>{const[l,n]=i.useState({}),a=i.useRef(null),r=i.useRef(!1),c=i.useRef(0),o=i.useRef(0),d=i.useRef(null);i.useEffect(()=>{const e={};s.forEach(s=>{e[s.key]=s.initialWidth||150}),n(e)},[s]);const m=i.useCallback(e=>{if(!r.current)return;const s=e.clientX-c.current,t=Math.max(50,o.current+s);n(e=>({...e,[d.current]:t}))},[]),x=i.useCallback(()=>{r.current=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",x),document.body.style.cursor="default",document.body.style.userSelect="auto",d.current=null},[m]),u=i.useCallback((e,s)=>{r.current=!0,c.current=e.clientX,d.current=s,o.current=l[s],document.addEventListener("mousemove",m),document.addEventListener("mouseup",x),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[l,m,x]);return e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsxs("table",{ref:a,className:"min-w-full divide-y divide-zinc-700 table-fixed",children:[e.jsx("thead",{className:"bg-zinc-800 border-b border-zinc-700",children:e.jsx("tr",{children:s.map((t,i)=>e.jsxs("th",{scope:"col",className:`relative px-4 sm:px-6 py-3 text-left text-xs font-medium text-zinc-300 uppercase tracking-wider ${t.sortable?"cursor-pointer hover:bg-zinc-700":""} ${"right"===t.align?"text-right":""}`,style:{width:l[t.key]},onClick:t.sortable?t.onSort:void 0,children:[e.jsx("div",{className:"flex items-center "+("right"===t.align?"justify-end":""),children:t.header}),i<s.length-1&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-full cursor-col-resize hover:bg-blue-300 opacity-0 hover:opacity-100 transition-opacity duration-100",onMouseDown:e=>u(e,t.key),style:{zIndex:1}})]},t.key))})}),e.jsx("tbody",{className:"bg-zinc-800 divide-y divide-zinc-700",children:t.map((t,i)=>e.jsx("tr",{className:"hover:bg-zinc-700 transition-colors",children:s.map(s=>e.jsx("td",{className:`px-4 sm:px-6 py-4 whitespace-nowrap text-sm ${"right"===s.align?"text-right":"text-left"} ${"actions"===s.key?"font-medium":"text-zinc-300"}`,style:{width:l[s.key]},children:s.render(t)},`${t.id||i}-${s.key}`))},t.id||i))})]})})},b=()=>{const{setPageTitle:b}=s(),[p,g]=i.useState([]),[j,f]=i.useState(!0),[v,y]=i.useState(null),[N,w]=i.useState(1),[z,k]=i.useState(10),[S,C]=i.useState(""),[_,L]=i.useState("title"),[M,$]=i.useState("asc"),E=l(),{user:P}=t();i.useEffect(()=>{b("Manage Songs"),W()},[b]);const W=async()=>{f(!0),y(null);try{const e=await a.getAllSongs();g(e)}catch(e){y(e.message||"Failed to fetch songs. Please try again.")}finally{f(!1)}},F=async e=>{if(window.confirm("Are you sure you want to delete this song?")){f(!0),y(null);try{await a.deleteSong(e),await W()}catch(s){y(s.message||"Failed to delete song. Please try again.")}finally{f(!1)}}},A=e=>{_===e?$("asc"===M?"desc":"asc"):(L(e),$("asc")),w(1)},B=i.useMemo(()=>{const e=S.toLowerCase();return p.filter(s=>s.original_artist.toLowerCase().includes(e)||s.title.toLowerCase().includes(e)||s.key_signature&&s.key_signature.toLowerCase().includes(e)||null!==s.tempo&&void 0!==s.tempo&&s.tempo.toString().includes(e))},[p,S]),R=i.useMemo(()=>_?[...B].sort((e,s)=>{const t=e[_],i=s[_];if("tempo"===_){const e=null!=t?Number(t):-1/0,s=null!=i?Number(i):-1/0;return e<s?"asc"===M?-1:1:e>s?"asc"===M?1:-1:0}const l=(t||"").toString().toLowerCase(),n=(i||"").toString().toLowerCase();return l<n?"asc"===M?-1:1:l>n?"asc"===M?1:-1:0}):B,[B,_,M]),D=Math.ceil(R.length/z),T=N*z,K=T-z,X=R.slice(K,T),q=e=>w(e),G=s=>_===s?"asc"===M?e.jsx(x,{size:16,className:"ml-1"}):e.jsx(u,{size:16,className:"ml-1"}):null,I=i.useMemo(()=>[{key:"title",header:e.jsxs("div",{className:"flex items-center",children:["Title ",G("title")]}),render:s=>e.jsx(n,{to:`/songs/${s.id}`,className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:s.title}),initialWidth:250,sortable:!0,onSort:()=>A("title")},{key:"original_artist",header:e.jsxs("div",{className:"flex items-center",children:["Artist ",G("original_artist")]}),render:e=>e.original_artist,initialWidth:200,sortable:!0,onSort:()=>A("original_artist")},{key:"tempo",header:e.jsxs("div",{className:"flex items-center",children:["Tempo (BPM) ",G("tempo")]}),render:e=>null!==e.tempo&&void 0!==e.tempo?`${e.tempo} BPM`:"-",initialWidth:130,sortable:!0,onSort:()=>A("tempo")},{key:"key_signature",header:e.jsxs("div",{className:"flex items-center",children:["Key ",G("key_signature")]}),render:e=>e.key_signature||"-",initialWidth:100,sortable:!0,onSort:()=>A("key_signature")},{key:"actions",header:"Actions",render:s=>e.jsx("div",{className:"flex justify-end space-x-2",children:P&&P.user_level>=2&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(`/songs/edit/${s.id}`),className:"text-indigo-600 hover:text-indigo-900 mr-3 dark:text-indigo-400 dark:hover:text-indigo-300",title:"Edit Song",children:e.jsx(r,{size:18})}),P&&P.user_level>=2&&e.jsx("button",{onClick:()=>F(s.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Delete Song",children:e.jsx(c,{size:18})})]})}),initialWidth:120,sortable:!1,align:"right"}],[_,M,A,F,E,P]);return e.jsxs("div",{className:"max-w-7xl mx-auto fade-in",children:[e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-2xl flex items-center justify-center",children:e.jsx(o,{className:"h-5 w-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-zinc-100",children:"Song Library"}),e.jsx("p",{className:"text-sm sm:text-base text-zinc-400",children:"Manage your music collection"})]})]})}),v&&e.jsx("div",{className:"bg-red-900/30 border border-red-800/50 text-red-200 px-4 py-3 rounded-xl mb-6 backdrop-blur-sm",role:"alert",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("strong",{className:"font-semibold",children:"Error"}),e.jsxs("span",{className:"block sm:inline",children:[" ",v]})]})]})}),e.jsxs("div",{className:"card-modern p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"w-full sm:w-2/3 lg:w-1/2",children:e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-zinc-400"}),e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search songs"}),e.jsx("input",{type:"text",id:"search",placeholder:"Search songs...",value:S,onChange:e=>{C(e.target.value),w(1)},className:"w-full pl-10 pr-4 py-3 bg-zinc-800 border border-zinc-700 text-zinc-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 placeholder-zinc-400"})]})}),P&&P.user_level>=2&&e.jsxs("button",{onClick:()=>E("/songs/add"),className:"w-full sm:w-auto inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 focus-ring shadow-lg btn-animate font-medium mobile-form-button",children:[e.jsx(m,{size:20,className:"mr-2 sm:mr-2"}),"Add Song"]})]}),j&&e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3,4,5].map(s=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-zinc-700 rounded-xl"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-zinc-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-zinc-700 rounded w-1/2"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-zinc-700 rounded-lg"}),e.jsx("div",{className:"w-8 h-8 bg-zinc-700 rounded-lg"})]})]},s))})}),!j&&0===p.length&&!v&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-zinc-800 rounded-3xl flex items-center justify-center mx-auto mb-6",children:e.jsx(o,{className:"h-12 w-12 text-zinc-600"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-zinc-200 mb-2",children:"No songs in your library"}),e.jsx("p",{className:"text-sm sm:text-base text-zinc-400 mb-8 max-w-md mx-auto px-4",children:"Get started by adding your first song to build your music collection."}),P&&P.user_level>=2&&e.jsxs("button",{onClick:()=>E("/songs/add"),className:"inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 focus-ring shadow-lg btn-animate font-medium mobile-form-button",children:[e.jsx(m,{size:20,className:"mr-2"}),"Add Your First Song"]})]}),!j&&p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block bg-zinc-900/50 rounded-xl overflow-hidden border border-zinc-800",children:e.jsx(h,{columns:I,data:X})}),e.jsx("div",{className:"sm:hidden space-y-3",children:X.map(s=>e.jsx("div",{className:"mobile-table-card",children:e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(n,{to:`/songs/${s.id}`,className:"text-lg font-semibold text-blue-400 hover:text-blue-300 transition-colors block mb-1",children:s.title}),e.jsx("p",{className:"text-base text-zinc-300 mb-1",children:s.original_artist}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-zinc-400",children:[s.key_signature&&e.jsxs("span",{children:["Key: ",s.key_signature]}),null!==s.tempo&&void 0!==s.tempo&&e.jsxs("span",{children:[s.tempo," BPM"]})]}),s.performance_note&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),e.jsx("span",{className:"text-sm text-amber-300",children:s.performance_note})]})]}),P&&P.user_level>=2&&e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsx("button",{onClick:()=>E(`/songs/edit/${s.id}`),className:"mobile-action-btn flex items-center justify-center",title:"Edit Song",children:e.jsx(r,{size:20,className:"text-blue-400"})}),e.jsx("button",{onClick:()=>F(s.id),className:"mobile-action-btn flex items-center justify-center",title:"Delete Song",children:e.jsx(c,{size:20,className:"text-red-400"})})]})]})},s.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-6 space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-2",children:[e.jsx("label",{htmlFor:"items-per-page",className:"text-base sm:text-sm text-zinc-400 font-medium",children:"Show:"}),e.jsxs("select",{id:"items-per-page",value:z,onChange:e=>{k(Number(e.target.value)),w(1)},className:"px-4 py-3 sm:px-3 sm:py-2 bg-zinc-800 border border-zinc-700 text-zinc-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors mobile-action-btn",children:[e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"})]}),e.jsxs("span",{className:"text-base sm:text-sm text-zinc-400",children:["of ",B.length," songs"]})]}),e.jsxs("nav",{className:"flex items-center space-x-1","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>q(N-1),disabled:1===N,className:"px-4 py-3 sm:px-3 sm:py-2 rounded-xl border border-zinc-700 bg-zinc-800 text-base sm:text-sm font-medium text-zinc-300 hover:bg-zinc-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all btn-animate mobile-action-btn",children:e.jsx(x,{size:16,className:"-rotate-90"})}),e.jsx("div",{className:"flex items-center space-x-2 px-4 sm:px-4",children:e.jsxs("span",{className:"text-base sm:text-sm text-zinc-400",children:["Page ",N," of ",D]})}),e.jsx("button",{onClick:()=>q(N+1),disabled:N===D,className:"px-4 py-3 sm:px-3 sm:py-2 rounded-xl border border-zinc-700 bg-zinc-800 text-base sm:text-sm font-medium text-zinc-300 hover:bg-zinc-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all btn-animate mobile-action-btn",children:e.jsx(u,{size:16,className:"-rotate-90"})})]})]})]})]})]})};export{b as default};
