import{a as e,u as s,j as t}from"./index-Babt8UfR.js";import{r as a}from"./vendor-react-ET7pSeaL.js";import{s as n,e as l,g as i}from"./services-P15qPlA6.js";import{h as r}from"./errorHandler-B2LE5V9y.js";import{U as o,R as c,y as d,K as m,h as x,n as u,o as h,z as p,l as b}from"./vendor-ui-CCR3b1TD.js";import"./vendor-supabase-DKeZICmP.js";const j=i("VITE_SUPABASE_URL",""),g=e=>{if(!j)throw new Error("Supabase base URL is not configured. Set VITE_SUPABASE_URL.");return`${j}/functions/v1/${e}`},v={getAllUsers:async()=>l.executeQuery(()=>n.from("users").select("*").order("created_at",{ascending:!1})),async getAuthUsersData(){try{const{data:{session:e}}=await n.auth.getSession();if(!e)throw new Error("Not authenticated");return(await l.fetchWithRetry(g("admin-list-users"),{method:"GET",headers:{Authorization:`Bearer ${e.access_token}`}})).users||[]}catch(e){throw r(e,"Failed to fetch auth users"),e}},async getMergedUsersData(){const[e,s]=await Promise.all([this.getAllUsers(),this.getAuthUsersData()]);return s.map(s=>{const t=e.find(e=>e.id===s.id);return{...s,...t,email:s.email||t?.email,last_sign_in_at:s.last_sign_in_at,email_confirmed_at:s.email_confirmed_at,created_at:s.created_at}})},async createUser(e){const{name:s,email:t,password:a,role:i,user_level:o}=e;if(!s||!t)throw new Error("Name and email are required");try{const{data:{session:e}}=await n.auth.getSession();if(!e)throw new Error("Not authenticated");const r=await l.fetchWithRetry(g("admin-invite-user"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({email:t,name:s,role:i||"",user_level:o||1,password:a||null})});return r.data.user}catch(c){throw r(c,"Error creating user"),c}},async updateUser(e,s){const{name:t,email:a,role:l,user_level:i}=s;if(!t||!a)throw new Error("Name and email are required");try{const{data:s}=await n.auth.admin.getUserById(e);s.user&&s.user.email!==a?await n.auth.admin.updateUserById(e,{email:a,user_metadata:{...s.user.user_metadata,name:t,role:l||"",user_level:i||1}}):s.user&&await n.auth.admin.updateUserById(e,{user_metadata:{...s.user.user_metadata,name:t,role:l||"",user_level:i||1}});const{data:r,error:o}=await n.from("users").update({name:t,email:a,role:l||"",user_level:i||1}).eq("id",e).select().single();if(o)throw o;return r}catch(r){throw r}},async deleteUser(e){try{const{data:{session:s}}=await n.auth.getSession();if(!s)throw new Error("Not authenticated");return await l.fetchWithRetry(g("admin-delete-user"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`},body:JSON.stringify({userId:e})}),!0}catch(s){throw r(s,"Error deleting user"),s}},async resetUserPassword(e,s=null){try{const{data:{session:t}}=await n.auth.getSession();if(!t)throw new Error("Not authenticated");if(s){const{data:t}=await n.auth.admin.listUsers(),a=t.users.find(s=>s.email===e);if(!a)throw new Error("User not found");const{error:l}=await n.auth.admin.updateUserById(a.id,{password:s});if(l)throw l}else await l.fetchWithRetry(g("admin-reset-password"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({email:e})})}catch(t){throw r(t,"Error resetting password"),t}},async syncUserProfile(e,s){const{name:t,email:a,role:l,user_level:i}=s,{error:r}=await n.rpc("sync_user_profile",{user_id:e,user_name:t,user_email:a,user_role:l,user_level:i});if(r)throw r},async resendInvitation(e){try{const{data:{session:s}}=await n.auth.getSession();if(!s)throw new Error("Not authenticated");await l.fetchWithRetry(g("admin-invite-user"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`},body:JSON.stringify({email:e})})}catch(s){throw r(s,"Failed to resend invitation"),s}}},f=()=>{const{user:n}=e(),{setPageTitle:l}=s(),[i,r]=a.useState([]),[j,g]=a.useState(!0),[f,w]=a.useState(null),[y,N]=a.useState(""),[z,_]=a.useState(!1),[k,C]=a.useState(!1),[U,S]=a.useState(null),[E,R]=a.useState(""),[L,A]=a.useState(!0),[I,P]=a.useState({name:"",role:"",email:"",user_level:1,password:"",sendInvite:!0}),[D,B]=a.useState(null);a.useEffect(()=>{l("User Management"),n&&3===n.user_level?G():g(!1)},[n,l]);const G=a.useCallback(async()=>{g(!0),w(null);try{const e=await v.getMergedUsersData();r(e)}catch(e){w(e.message)}finally{g(!1)}},[]),F=e=>{N(e),setTimeout(()=>N(""),5e3)},T=e=>{const{name:s,value:t}=e.target,a="user_level"===s?parseInt(t,10):t;P({...I,[s]:a})},O=e=>{const{name:s,value:t}=e.target,a="user_level"===s?parseInt(t,10):t;B({...D,[s]:a})},M=async e=>{e.preventDefault(),w(null),N("");try{await v.updateUser(D.id,{name:D.name,email:D.email,role:D.role,user_level:D.user_level}),await G(),B(null),F("User updated successfully!")}catch(s){w(s.message)}},V=async e=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone.")){w(null),N("");try{await v.deleteUser(e),await G(),F("User deleted successfully!")}catch(s){w(s.message)}}},W=async e=>{w(null),N("");try{await v.resendInvitation(e),F("Invitation resent successfully!")}catch(s){w(s.message)}},q=e=>{S(e),R(""),A(!0),C(!0)},K=e=>{switch(e){case 3:return t.jsxs("span",{className:"badge bg-red-600 text-white border-red-500",children:[t.jsx(b,{size:12,className:"mr-1"}),"Admin"]});case 2:return t.jsxs("span",{className:"badge bg-blue-600 text-white border-blue-500",children:[t.jsx(u,{size:12,className:"mr-1"}),"Editor"]});default:return t.jsxs("span",{className:"badge badge-secondary",children:[t.jsx(p,{size:12,className:"mr-1"}),"User"]})}};return n&&3===n.user_level?t.jsxs("div",{className:"max-w-7xl mx-auto fade-in",children:[t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("div",{className:"w-10 h-10 bg-emerald-500/10 rounded-2xl flex items-center justify-center",children:t.jsx(o,{className:"h-5 w-5 text-emerald-400"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-zinc-100",children:"User Management"}),t.jsx("p",{className:"text-zinc-400",children:"Manage system users and permissions"})]})]})}),f&&t.jsx("div",{className:"bg-red-900/30 border border-red-800/50 text-red-200 px-4 py-3 rounded-xl mb-6 backdrop-blur-sm",role:"alert",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("strong",{className:"font-semibold",children:"Error"}),t.jsxs("span",{className:"block sm:inline",children:[" ",f]})]})]})}),y&&t.jsx("div",{className:"bg-green-900/30 border border-green-800/50 text-green-200 px-4 py-3 rounded-xl mb-6 backdrop-blur-sm",role:"alert",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"font-medium",children:y})]})}),t.jsxs("div",{className:"card-modern p-4 lg:p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0",children:[t.jsxs("button",{onClick:G,disabled:j,className:"inline-flex items-center px-4 py-2 bg-zinc-600 text-zinc-100 rounded-xl hover:bg-zinc-500 disabled:opacity-50 transition-colors font-medium",children:[t.jsx(c,{size:16,className:"mr-2 "+(j?"animate-spin":"")}),"Refresh"]}),t.jsxs("button",{onClick:()=>_(!z),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors font-medium",children:[t.jsx(d,{size:20,className:"mr-2"}),z?"Cancel":"Add User"]})]}),z&&t.jsxs("div",{className:"p-4 border border-zinc-700 rounded-xl bg-zinc-800 mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-zinc-100 mb-4",children:"Add New User"}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(null),N(""),g(!0);try{const e={name:I.name,email:I.email,role:I.role,user_level:I.user_level,password:I.sendInvite?null:I.password};await v.createUser(e),await G(),P({name:"",role:"",email:"",user_level:1,password:"",sendInvite:!0}),_(!1);const s=I.sendInvite?"User invited successfully! They will receive an email to complete their profile.":"User created successfully with the specified password.";F(s)}catch(s){w(s.message)}finally{g(!1)}},className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Full Name"}),t.jsx("input",{type:"text",id:"name",name:"name",value:I.name,onChange:T,required:!0,className:"input-modern"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Email"}),t.jsx("input",{type:"email",id:"email",name:"email",value:I.email,onChange:T,required:!0,className:"input-modern"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Role"}),t.jsxs("select",{id:"role",name:"role",value:I.role,onChange:T,className:"input-modern",children:[t.jsx("option",{value:"",children:"Select a role"}),t.jsx("option",{value:"Bass Guitar",children:"Bass Guitar"}),t.jsx("option",{value:"Drums",children:"Drums"}),t.jsx("option",{value:"Lead Guitar",children:"Lead Guitar"}),t.jsx("option",{value:"Rhythm Guitar",children:"Rhythm Guitar"}),t.jsx("option",{value:"Keyboard",children:"Keyboard"}),t.jsx("option",{value:"Vocals",children:"Vocals"}),t.jsx("option",{value:"Sound Engineer",children:"Sound Engineer"}),t.jsx("option",{value:"Other",children:"Other"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"user_level",className:"block text-sm font-medium text-zinc-300 mb-2",children:"User Level"}),t.jsxs("select",{id:"user_level",name:"user_level",value:I.user_level,onChange:T,className:"input-modern",children:[t.jsx("option",{value:"1",children:"User"}),t.jsx("option",{value:"2",children:"Editor"}),t.jsx("option",{value:"3",children:"Admin"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"sendInvite",type:"checkbox",checked:I.sendInvite,onChange:e=>P({...I,sendInvite:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-zinc-600 rounded bg-zinc-700"}),t.jsx("label",{htmlFor:"sendInvite",className:"ml-2 block text-sm text-zinc-300",children:"Send invitation email (user will set their own password)"})]}),!I.sendInvite&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Password"}),t.jsx("input",{type:"password",id:"password",name:"password",value:I.password,onChange:T,required:!I.sendInvite,className:"input-modern",placeholder:"Enter password for new user..."})]})]}),t.jsxs("div",{className:"flex justify-end space-x-3",children:[t.jsx("button",{type:"button",onClick:()=>_(!1),className:"inline-flex items-center px-4 py-2 border border-zinc-600 rounded-xl text-zinc-300 bg-zinc-700 hover:bg-zinc-600 transition-colors",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:j,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors font-medium",children:j?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(d,{size:16,className:"mr-2"}),I.sendInvite?"Send Invitation":"Create User"]})})]})]})]}),j?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-zinc-300",children:"Loading users..."})]}):0===i.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(o,{className:"mx-auto h-12 w-12 text-zinc-600 mb-4"}),t.jsx("p",{className:"text-zinc-300 text-lg mb-2",children:"No users found"}),t.jsx("p",{className:"text-zinc-400",children:"Users will appear here once they are added to the system."})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"hidden md:block bg-zinc-900/50 rounded-xl overflow-hidden border border-zinc-800",children:t.jsxs("table",{className:"min-w-full divide-y divide-slate-600",children:[t.jsx("thead",{className:"bg-zinc-800",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-zinc-300 uppercase tracking-wider",children:"Name"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:"Role"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:"Email"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:"User Level"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:"Status"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:"Last Login"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-slate-300 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:i.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:t.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-medium text-white",children:e.name?e.name.charAt(0).toUpperCase():e.email?.charAt(0).toUpperCase()||"U"})})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("div",{className:"text-sm font-medium text-slate-100",children:e.name||"No name"}),t.jsx("div",{className:"text-sm text-slate-400",children:e.email})]})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:e.role||t.jsx("span",{className:"text-slate-500 italic",children:"Not specified"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:K(e.user_level)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.email_confirmed_at?t.jsx("span",{className:"badge badge-success",children:"Confirmed"}):t.jsx("span",{className:"badge bg-yellow-600 text-white border-yellow-500",children:"Pending"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:D?.id===e.id?t.jsx("div",{className:"space-y-2",children:t.jsxs("form",{onSubmit:M,className:"space-y-2",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("input",{type:"text",name:"name",value:D.name||"",onChange:O,placeholder:"Full Name",className:"px-3 py-1 bg-slate-600 border border-slate-500 rounded-md text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),t.jsx("input",{type:"email",name:"email",value:D.email||"",onChange:O,placeholder:"Email",className:"px-3 py-1 bg-slate-600 border border-slate-500 rounded-md text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{name:"role",value:D.role||"",onChange:O,className:"px-3 py-1 bg-slate-600 border border-slate-500 rounded-md text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[t.jsx("option",{value:"",children:"Select a role"}),t.jsx("option",{value:"Bass Guitar",children:"Bass Guitar"}),t.jsx("option",{value:"Drums",children:"Drums"}),t.jsx("option",{value:"Lead Guitar",children:"Lead Guitar"}),t.jsx("option",{value:"Rhythm Guitar",children:"Rhythm Guitar"}),t.jsx("option",{value:"Keyboard",children:"Keyboard"}),t.jsx("option",{value:"Vocals",children:"Vocals"}),t.jsx("option",{value:"Sound Engineer",children:"Sound Engineer"}),t.jsx("option",{value:"Other",children:"Other"})]}),t.jsxs("select",{name:"user_level",value:D.user_level||1,onChange:O,className:"px-3 py-1 bg-slate-600 border border-slate-500 rounded-md text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[t.jsx("option",{value:"1",children:"User"}),t.jsx("option",{value:"2",children:"Editor"}),t.jsx("option",{value:"3",children:"Admin"})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("button",{type:"submit",className:"inline-flex items-center px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm transition-colors",children:"Save"}),t.jsx("button",{type:"button",onClick:()=>B(null),className:"inline-flex items-center px-3 py-1 border border-slate-600 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 text-sm transition-colors",children:"Cancel"})]})]})}):t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("button",{onClick:()=>q(e),className:"inline-flex items-center px-2 py-1 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors text-xs",title:"Reset Password",children:t.jsx(m,{size:12})}),t.jsx("button",{onClick:()=>W(e.email),className:"inline-flex items-center px-2 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",title:"Resend Invitation",children:t.jsx(x,{size:12})}),t.jsx("button",{onClick:()=>B(e),className:"inline-flex items-center px-2 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",title:"Edit User",children:t.jsx(u,{size:12})}),t.jsx("button",{onClick:()=>V(e.id),disabled:e.id===n?.id,className:"inline-flex items-center px-2 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-xs",title:e.id===n?.id?"Cannot delete yourself":"Delete User",children:t.jsx(h,{size:12})})]})})]},e.id))})]})}),t.jsx("div",{className:"md:hidden space-y-4",children:i.map(e=>t.jsxs("div",{className:"bg-zinc-800 rounded-xl p-4 border border-zinc-700",children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-medium text-white",children:e.name?e.name.charAt(0).toUpperCase():e.email?.charAt(0).toUpperCase()||"U"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-base font-semibold text-zinc-100 truncate",children:e.name||"No name"}),t.jsx("p",{className:"text-sm text-zinc-400 truncate",children:e.email}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[K(e.user_level),e.email_confirmed_at?t.jsx("span",{className:"badge badge-success text-xs",children:"Confirmed"}):t.jsx("span",{className:"badge bg-yellow-600 text-white border-yellow-500 text-xs",children:"Pending"})]})]})]})}),t.jsxs("div",{className:"text-sm text-zinc-300 mb-3",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Role:"})," ",e.role||"Not specified"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Last Login:"})," ",e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString():"Never"]})]}),D?.id===e.id?t.jsxs("form",{onSubmit:M,className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsx("input",{type:"text",name:"name",value:D.name||"",onChange:O,placeholder:"Full Name",className:"input-modern text-sm"}),t.jsx("input",{type:"email",name:"email",value:D.email||"",onChange:O,placeholder:"Email",className:"input-modern text-sm"}),t.jsxs("select",{name:"role",value:D.role||"",onChange:O,className:"input-modern text-sm",children:[t.jsx("option",{value:"",children:"Select a role"}),t.jsx("option",{value:"Bass Guitar",children:"Bass Guitar"}),t.jsx("option",{value:"Drums",children:"Drums"}),t.jsx("option",{value:"Lead Guitar",children:"Lead Guitar"}),t.jsx("option",{value:"Rhythm Guitar",children:"Rhythm Guitar"}),t.jsx("option",{value:"Keyboard",children:"Keyboard"}),t.jsx("option",{value:"Vocals",children:"Vocals"}),t.jsx("option",{value:"Sound Engineer",children:"Sound Engineer"}),t.jsx("option",{value:"Other",children:"Other"})]}),t.jsxs("select",{name:"user_level",value:D.user_level||1,onChange:O,className:"input-modern text-sm",children:[t.jsx("option",{value:"1",children:"User"}),t.jsx("option",{value:"2",children:"Editor"}),t.jsx("option",{value:"3",children:"Admin"})]})]}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 text-sm transition-colors",children:"Save"}),t.jsx("button",{type:"button",onClick:()=>B(null),className:"inline-flex items-center px-4 py-2 border border-zinc-600 bg-zinc-700 text-zinc-300 rounded-xl hover:bg-zinc-600 text-sm transition-colors",children:"Cancel"})]})]}):t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>q(e),className:"inline-flex items-center px-3 py-2 bg-yellow-600 text-white rounded-xl hover:bg-yellow-700 transition-colors text-sm",title:"Reset Password",children:[t.jsx(m,{size:16,className:"mr-1"}),"Reset Password"]}),t.jsxs("button",{onClick:()=>W(e.email),className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors text-sm",title:"Resend Invitation",children:[t.jsx(x,{size:16,className:"mr-1"}),"Resend"]}),t.jsxs("button",{onClick:()=>B(e),className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors text-sm",title:"Edit User",children:[t.jsx(u,{size:16,className:"mr-1"}),"Edit"]}),t.jsxs("button",{onClick:()=>V(e.id),disabled:e.id===n?.id,className:"inline-flex items-center px-3 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",title:e.id===n?.id?"Cannot delete yourself":"Delete User",children:[t.jsx(h,{size:16,className:"mr-1"}),"Delete"]})]})]},e.id))})]}),k&&t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 transition-opacity",onClick:()=>C(!1)}),t.jsxs("div",{className:"inline-block align-bottom bg-zinc-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[t.jsx("div",{className:"bg-zinc-800 px-6 pt-6 pb-4",children:t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-900/50",children:t.jsx(m,{className:"h-6 w-6 text-yellow-400"})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-lg font-medium text-zinc-100",children:"Reset Password"}),t.jsxs("p",{className:"text-sm text-zinc-400",children:["Reset password for ",U?.name||U?.email]})]})]})}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(null),N("");try{const e=L?null:E;await v.resetUserPassword(U.email,e);F(L?"Password reset email sent successfully!":"Password updated successfully!"),C(!1),S(null),R("")}catch(s){w(s.message)}},className:"px-6 pb-6 space-y-4",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"sendPasswordEmail",type:"checkbox",checked:L,onChange:e=>A(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-zinc-600 rounded bg-zinc-700"}),t.jsx("label",{htmlFor:"sendPasswordEmail",className:"ml-2 block text-sm text-zinc-300",children:"Send password reset email (let user set their own password)"})]}),!L&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-zinc-300 mb-2",children:"New Password"}),t.jsx("input",{type:"password",id:"newPassword",value:E,onChange:e=>R(e.target.value),required:!L,className:"input-modern",placeholder:"Enter new password..."})]})]}),t.jsxs("div",{className:"flex justify-end space-x-3",children:[t.jsx("button",{type:"button",onClick:()=>C(!1),className:"inline-flex items-center px-4 py-2 border border-zinc-600 rounded-xl text-zinc-300 bg-zinc-700 hover:bg-zinc-600 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 bg-yellow-600 text-white rounded-xl hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-colors font-medium",children:[t.jsx(m,{size:16,className:"mr-2"}),L?"Send Reset Email":"Set Password"]})]})]})]})]})})]})]}):t.jsx("div",{className:"max-w-7xl mx-auto fade-in",children:t.jsxs("div",{className:"card-modern p-6 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h2",{className:"text-xl font-semibold text-zinc-100 mb-2",children:"Access Denied"}),t.jsx("p",{className:"text-zinc-300",children:"You do not have permission to view this page."})]})})};export{f as default};
