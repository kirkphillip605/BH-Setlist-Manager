import{j as e,a as s,u as t}from"./index-Babt8UfR.js";import{r as n,l,h as i}from"./vendor-react-ET7pSeaL.js";import{c as a,d as o}from"./services-P15qPlA6.js";import{S as r}from"./SongSelectorModal-DQDBqQYu.js";import{B as c,X as d,T as m,v as x,j as u,t as g,M as p}from"./vendor-ui-CCR3b1TD.js";import{D as b}from"./DraggableList-C0Rm0Xlq.js";import"./vendor-supabase-DKeZICmP.js";const h=({isOpen:s,onClose:t,onCollectionSelected:l})=>{const[i,o]=n.useState([]),[r,m]=n.useState(!0),[x,u]=n.useState(null);n.useEffect(()=>{s&&g()},[s]);const g=async()=>{m(!0),u(null);try{const e=await a.getAllSongCollections();o(e)}catch(e){u(e.message||"Failed to fetch collections")}finally{m(!1)}};return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm transition-opacity",onClick:t}),e.jsxs("div",{className:"inline-block align-bottom bg-zinc-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:[e.jsx("div",{className:"bg-zinc-800 px-6 pt-6 pb-4 border-b border-zinc-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/10 rounded-xl flex items-center justify-center",children:e.jsx(c,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-zinc-100",children:"Select Collection"}),e.jsx("p",{className:"text-sm text-zinc-400",children:"Choose a collection to add songs from"})]})]}),e.jsx("button",{onClick:t,className:"p-2 text-zinc-400 hover:text-zinc-200 transition-colors",children:e.jsx(d,{size:20})})]})}),e.jsx("div",{className:"bg-zinc-800 px-6 py-4",style:{maxHeight:"400px",overflowY:"auto"},children:r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-zinc-300",children:"Loading collections..."})]}):x?e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{children:x})}):0===i.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(c,{className:"h-12 w-12 text-zinc-600 mx-auto mb-3"}),e.jsx("p",{className:"text-zinc-400 mb-2",children:"No collections available"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Create a collection first to use this feature"})]}):e.jsx("div",{className:"space-y-3",children:i.map(s=>e.jsx("button",{onClick:()=>(e=>{l(e),t()})(s),className:"w-full text-left p-4 bg-zinc-700 rounded-xl border border-zinc-600 hover:bg-zinc-600 hover:border-zinc-500 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-100 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[s.is_public?e.jsx("span",{className:"px-2 py-1 bg-emerald-600/20 text-emerald-300 text-xs rounded-full border border-emerald-600/30",children:"Public"}):e.jsx("span",{className:"px-2 py-1 bg-zinc-600/50 text-zinc-400 text-xs rounded-full border border-zinc-600",children:"Private"}),e.jsx("span",{className:"text-xs text-zinc-400",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"p-2 bg-blue-600 text-white rounded-lg",children:e.jsx(Plus,{size:16})})})]})},s.id))})}),e.jsx("div",{className:"bg-zinc-700 px-6 py-4",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:t,className:"inline-flex items-center px-4 py-2 border border-zinc-600 rounded-xl text-zinc-300 bg-zinc-800 hover:bg-zinc-700 transition-colors",children:"Cancel"})})})]})]})}):null},f=({isOpen:s,onClose:t,duplicates:n=[],onRemoveDuplicates:l,onKeepInCurrentSet:i,onKeepInOriginalSet:a,type:o="set"})=>{if(!s)return null;return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-2 sm:px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75 backdrop-blur-sm"})}),e.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-slate-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full mobile-modal",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 px-4 sm:px-6 pt-6 pb-4 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 dark:bg-yellow-900/50 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(m,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left flex-1",children:[e.jsx("h3",{className:"text-lg sm:text-lg leading-6 font-medium text-gray-900 dark:text-gray-100",children:"Duplicate Songs Found"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-base sm:text-sm text-gray-500 dark:text-gray-400 mb-4",children:["The following songs already exist in other ","set"===o?"sets within this setlist":"locations",". Choose how you would like to resolve each duplicate so this ","set"===o?"set":"collection"," can be saved."]}),e.jsx("div",{className:"max-h-40 overflow-y-auto scroll-container",children:n.map((s,t)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700 p-4 sm:p-3 rounded-xl mb-3 sm:mb-2",children:[e.jsxs("p",{className:"text-base sm:text-sm font-medium text-gray-900 dark:text-gray-100",children:[s.songs?.title," by ",s.songs?.original_artist]}),s.sets?.name&&e.jsxs("p",{className:"text-sm sm:text-xs text-gray-600 dark:text-gray-400",children:["Currently in: ",s.sets.name]})]},t))})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700 px-4 sm:px-6 py-4 sm:py-3 flex flex-col sm:flex-row-reverse space-y-3 sm:space-y-0 sm:space-x-reverse sm:space-x-3",children:["set"===o&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>{i()},className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-transparent shadow-sm px-4 py-3 sm:py-2 bg-blue-600 text-base sm:text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 mobile-form-button",children:"Keep in This Set (remove from others)"}),e.jsx("button",{type:"button",onClick:()=>{a()},className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-gray-300 dark:border-slate-600 shadow-sm px-4 py-3 sm:py-2 bg-white dark:bg-slate-800 text-base sm:text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 mobile-form-button",children:"Keep in Existing Set(s)"})]}),e.jsx("button",{type:"button",onClick:()=>{l()},className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-transparent shadow-sm px-4 py-3 sm:py-2 bg-red-600 text-base sm:text-sm font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 mobile-form-button",children:"Remove from All Sets"}),e.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-gray-300 dark:border-slate-600 shadow-sm px-4 py-3 sm:py-2 bg-white dark:bg-slate-800 text-base sm:text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 mobile-form-button",children:"Cancel"})]})]})]})})},y=({isOpen:s,onClose:t,duplicates:n={},onSkipDuplicates:l,onMoveSongs:i,targetSetName:a="current set"})=>{if(!s)return null;const o=Object.keys(n),r=o.reduce((e,s)=>e+n[s].songs.length,0),c=o.some(e=>!n[e].isCurrentSet),u=(e,s)=>{i(e,s)};return 0===r?null:e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-2 sm:px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-black bg-opacity-75 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"inline-block align-bottom bg-zinc-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full mobile-modal",children:[e.jsx("div",{className:"bg-zinc-800 px-4 sm:px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-900/50",children:e.jsx(m,{className:"h-6 w-6 text-yellow-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg sm:text-lg leading-6 font-medium text-zinc-100",children:"Duplicate Songs Found"}),e.jsxs("p",{className:"text-sm sm:text-sm text-zinc-400 mt-1",children:[r," song",1!==r?"s":""," from the collection already exist in this setlist"]})]})]}),e.jsx("button",{onClick:t,className:"text-zinc-400 hover:text-zinc-200 transition-colors p-2 mobile-action-btn",children:e.jsx(d,{className:"h-6 w-6 sm:h-6 sm:w-6"})})]})}),e.jsx("div",{className:"bg-zinc-800 px-4 sm:px-6 pb-4 max-h-96 overflow-y-auto mobile-modal-content scroll-container",children:o.map(s=>{const t=n[s];return e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-base sm:text-md font-medium text-zinc-100",children:[t.isCurrentSet?"Already in Current Set":`From "${t.setName}"`," (",t.songs.length," song",1!==t.songs.length?"s":"",")"]}),t.isCurrentSet?e.jsx("span",{className:"inline-flex items-center px-3 py-2 sm:px-3 sm:py-1 bg-gray-600 text-gray-300 text-sm rounded-lg mobile-action-btn",children:"Already in Set"}):e.jsxs("button",{onClick:()=>(e=>{const s=n[e].songs.map(e=>e.id);u(e,s)})(s),className:"inline-flex items-center px-3 py-2 sm:px-3 sm:py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors mobile-action-btn",children:[e.jsx(x,{size:16,className:"mr-1 sm:w-3 sm:h-3"}),"Move All to ",a]})]}),e.jsx("div",{className:"space-y-3 sm:space-y-2",children:t.songs.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-3 bg-zinc-700 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-base sm:text-sm font-medium text-zinc-100",children:n.title}),e.jsx("p",{className:"text-sm sm:text-xs text-zinc-400",children:n.original_artist})]}),t.isCurrentSet?e.jsx("span",{className:"inline-flex items-center px-3 py-2 sm:px-3 sm:py-1 bg-gray-600 text-gray-300 text-sm rounded-lg mobile-action-btn",children:"Already in Set"}):e.jsxs("button",{onClick:()=>{return e=s,t=n.id,void u(e,[t]);var e,t},className:"inline-flex items-center px-3 py-2 sm:px-3 sm:py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors mobile-action-btn",children:[e.jsx(x,{size:16,className:"mr-1 sm:w-3 sm:h-3"}),"Move to ",a]})]},n.id))})]},s)})}),e.jsxs("div",{className:"bg-zinc-700 px-4 sm:px-6 py-4 sm:py-4 flex flex-col sm:flex-row-reverse space-y-3 sm:space-y-0 sm:space-x-reverse sm:space-x-3",children:[e.jsx("button",{type:"button",onClick:l,className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-transparent shadow-sm px-4 py-3 sm:py-2 bg-green-600 text-base sm:text-sm font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 mobile-form-button",children:c?"Skip All Duplicates":"Continue Without Adding Duplicates"}),e.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-zinc-600 shadow-sm px-4 py-3 sm:py-2 bg-zinc-800 text-base sm:text-sm font-medium text-zinc-300 hover:bg-zinc-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 mobile-form-button",children:"Cancel"})]})]})]})})},j=()=>{const{setlistId:d,setId:m}=l(),{user:x}=s(),{setPageTitle:j}=t(),v=i(),[N,w]=n.useState(!1),[S,k]=n.useState(null),[z,C]=n.useState(""),[_,D]=n.useState([]),[F,O]=n.useState(!1),[A,E]=n.useState(!1),[I,$]=n.useState([]),[M,P]=n.useState(!1),[K,L]=n.useState([]),[R,T]=n.useState(!1),[B,U]=n.useState({}),[q,H]=n.useState([]),[J,W]=n.useState([]),Y=!!m;n.useEffect(()=>{Y?(j("Edit Set"),G()):(j("New Set"),C(""),D([])),Q()},[m,Y,j]);const G=async()=>{w(!0),k(null);try{const e=await o.getSetById(m);C(e.name);const s=e.set_songs?.map(e=>({...e.songs,song_order:e.song_order})).sort((e,s)=>e.song_order-s.song_order)||[];D(s)}catch(e){k(e.message||"Failed to load set")}finally{w(!1)}},Q=async()=>{try{const e=await a.getAllSongCollections();$(e)}catch(e){}},V=e=>e.map((e,s)=>({...e,song_order:s+1})),X=()=>{const e=new Set;Object.values(B).forEach(s=>{s.songs.forEach(s=>e.add(s.id))});const s=new Set(_.map(e=>e.id)),t=q.filter(t=>!e.has(t.id)&&!s.has(t.id));t.length>0&&D(e=>V([...e,...t])),T(!1),U({}),H([])},Z=async(e=_)=>{w(!0),k(null);const s=(e=>({name:z.trim(),setlist_id:d,songs:e.map(e=>({song_id:e.id,song_order:e.song_order}))}))(e);try{if(Y)await o.updateSet(m,s),v(`/setlists/${d}/sets/${m}`);else{const e=await o.createSet(s);v(`/setlists/${d}/sets/${e.id}`)}}catch(t){try{const s=JSON.parse(t.message);if("DUPLICATES_FOUND"===s.type)return W(e),L(s.duplicates),void P(!0)}catch(n){}k(t.message||"Failed to save set")}finally{w(!1)}},ee=()=>{const e=new Map;return K.forEach(s=>{if(!s.sets||!s.sets.id)return;const t=`${s.sets.id}:${s.song_id}`;e.has(t)||e.set(t,s)}),Array.from(e.values())},se=()=>{P(!1),L([]),W([])};return N&&Y?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:e.jsx("p",{className:"text-center text-slate-300",children:"Loading set..."})})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[S&&e.jsxs("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",S]})]}),e.jsx("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!z.trim())return void k("Set name is required");const s=V(_);D(s),await Z(s)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"setName",className:"block text-sm font-medium text-slate-300 mb-2",children:"Set Name"}),e.jsx("input",{type:"text",id:"setName",value:z,onChange:e=>C(e.target.value),className:"block w-full px-4 py-3 bg-slate-700 border border-slate-600 text-slate-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter set name...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{type:"button",onClick:()=>{v(`/setlists/${d}`)},className:"inline-flex items-center px-4 py-2 border border-slate-600 rounded-lg text-slate-300 bg-slate-700 hover:bg-slate-600 transition-colors",children:[e.jsx(u,{size:18,className:"mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:N||!z.trim(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(g,{size:18,className:"mr-2"}),N?"Saving...":Y?"Update Set":"Create Set"]})]})]})}),e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 lg:p-6 border border-slate-700",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-2 sm:space-y-0",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-100",children:"Songs in Set"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 w-full sm:w-auto",children:[I.length>0&&e.jsxs("button",{onClick:()=>E(!0),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[e.jsx(c,{size:18,className:"mr-2"}),"Add from Collection"]}),e.jsxs("button",{onClick:()=>O(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx(p,{size:18,className:"mr-2"}),"Add Songs"]})]})]}),e.jsx("div",{className:"space-y-4",children:0===_.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),e.jsx("p",{className:"text-slate-300 text-lg mb-2",children:"No songs in set"}),e.jsx("p",{className:"text-slate-400",children:"Add songs to build your set"})]}):e.jsx(b,{items:_,onReorder:(e,s)=>{D(t=>{const n=[...t],[l]=n.splice(e,1);return n.splice(s,0,l),V(n)})},onRemove:e=>{D(s=>V(s.filter((s,t)=>t!==e)))},type:"songs"})})]}),e.jsx(r,{isOpen:F,onClose:()=>O(!1),onSongsSelected:e=>{const s=new Set(_.map(e=>e.id)),t=e.filter(e=>!s.has(e.id));t.length>0&&D(e=>V([...e,...t])),O(!1)},selectedSongs:_,setlistId:d}),e.jsx(f,{isOpen:M,onClose:()=>P(!1),duplicates:K,onRemoveDuplicates:async()=>{w(!0);try{const e=ee();await Promise.all(e.map(e=>o.removeSongFromSet(e.sets.id,e.song_id)));const s=new Set(K.map(e=>e.song_id)),t=J.length>0?J:_,n=V(t.filter(e=>!s.has(e.id)));D(n),se(),await Z(n)}catch(e){k("Failed to remove duplicate songs"),w(!1)}},onKeepInCurrentSet:async()=>{w(!0);try{const e=ee();await Promise.all(e.map(e=>o.removeSongFromSet(e.sets.id,e.song_id)));const s=J.length>0?J:_,t=V(s);D(t),se(),await Z(t)}catch(e){k("Failed to move duplicate songs from other sets"),w(!1)}},onKeepInOriginalSet:async()=>{w(!0);try{const e=new Set(K.map(e=>e.song_id)),s=J.length>0?J:_,t=V(s.filter(s=>!e.has(s.id)));D(t),se(),await Z(t)}catch(e){k("Failed to keep duplicate songs in their original sets"),w(!1)}},type:"set"}),e.jsx(h,{isOpen:A,onClose:()=>E(!1),onCollectionSelected:async e=>{try{const s=await a.getSongCollectionById(e.id),t=s.song_collection_songs?.map(e=>({...e.songs,song_order:_.length+e.song_order})).sort((e,s)=>e.song_order-s.song_order)||[];if(0===t.length)return void k("Selected collection is empty");const n=t.map(e=>e.id),l=await o.checkCollectionDuplicates(d,n,m);if(Object.keys(l).length>0)U(l),H(t),T(!0);else{const e=new Set(_.map(e=>e.id)),s=t.filter(s=>!e.has(s.id));s.length>0&&D(e=>V([...e,...s]))}}catch(s){k("Failed to load collection songs")}}}),e.jsx(y,{isOpen:R,onClose:()=>{U({}),H([])},duplicates:B,onSkipDuplicates:X,onMoveSongs:async(e,s)=>{try{Y&&await o.moveSongsBetweenSets(s,e,m);const t={...B},n=t[e];n&&(n.songs=n.songs.filter(e=>!s.includes(e.id)),0===n.songs.length&&delete t[e]),U(t);const l=q.filter(e=>s.includes(e.id)),i=new Set(_.map(e=>e.id)),a=l.filter(e=>!i.has(e.id));a.length>0&&D(e=>V([...e,...a])),0===Object.keys(t).length&&X()}catch(t){k("Failed to move songs between sets")}},targetSetName:z||"this set"})]})};export{j as default};
